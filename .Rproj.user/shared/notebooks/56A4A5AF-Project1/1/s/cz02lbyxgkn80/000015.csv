"0","# Define the 4D vectors"
"0","a1 <- c(0.539, 0.000, 0.173, 0.825)"
"0","a2 <- c(0.316, 0.300, 0.346, 0.831)"
"0","a3 <- c(0.458, 0.265, 0.245, 0.812)"
"0","a4 <- c(0.468, 0.000, 0.458, 0.755)"
"0","a5 <- c(0.437, 0.217, 0.277, 0.828)"
"0",""
"0","# Create a data frame with the vectors"
"0","data <- data.frame("
"0","  x = c(a1[1], a2[1], a3[1], a4[1], a5[1]),"
"0","  y = c(a1[2], a2[2], a3[2], a4[2], a5[2]),"
"0","  z = c(a1[3], a2[3], a3[3], a4[3], a5[3]),"
"0","  w = c(a1[4], a2[4], a3[4], a4[4], a5[4])"
"0",")"
"0",""
"0","# Define a color ramp function"
"0","color_ramp <- colorRamp(c(""blue"", ""red""))"
"0",""
"0","# Map the fourth dimension to colors"
"0","data$colors <- rgb(color_ramp( (data$w - min(data$w)) / (max(data$w) - min(data$w)) ), maxColorValue = 255)"
"0",""
"0","# Create the 3D plot"
"0","p1 <- plot_ly() %>%"
"0","  add_trace("
"0","    x = data$x[1], y = data$y[1], z = data$z[1],"
"0","    type = 'scatter3d', mode = 'markers',"
"0","    marker = list(size = 3),"
"0","    name = 'a<sub>1</sub>',"
"0","    hovertext = paste("" x: "", data$x[1], ""<br>"", ""y: "", ""0.000"", ""<br>"", ""z: "","
"0","                data$z[1], ""<br>"", ""w: "", data$w[1]),  # Add w value to hovertext"
"0","    hoverinfo = ""name+text"""
"0","  ) %>%"
"0","  add_trace("
"0","    x = data$x[2], y = data$y[2], z = data$z[2],"
"0","    type = 'scatter3d', mode = 'markers',"
"0","    marker = list(size = 3),"
"0","    name = 'a<sub>2</sub>',"
"0","    hovertext = paste("" x: "", data$x[2], ""<br>"", ""y: "", ""0.300"", ""<br>"", ""z: "","
"0","                data$z[2], ""<br>"", ""w: "", data$w[2]),  # Add w value to hovertext"
"0","    hoverinfo = ""name+text"""
"0","  ) %>%"
"0","  add_trace("
"0","    x = data$x[3], y = data$y[3], z = data$z[3],"
"0","    type = 'scatter3d', mode = 'markers',"
"0","    marker = list(size = 3),"
"0","    name = 'a<sub>3</sub>',"
"0","    hovertext = paste("" x: "", data$x[3], ""<br>"", ""y: "", data$y[3], ""<br>"", ""z: "","
"0","                data$z[3], ""<br>"", ""w: "", data$w[3]),  # Add w value to hovertext"
"0","    hoverinfo = ""name+text"""
"0","  ) %>%"
"0","  add_trace("
"0","    x = data$x[4], y = data$y[4], z = data$z[4],"
"0","    type = 'scatter3d', mode = 'markers',"
"0","    marker = list(size = 3),"
"0","    name = 'a<sub>4</sub>',"
"0","    hovertext = paste("" x: "", data$x[4], ""<br>"", ""y: "", ""0.000"", ""<br>"", ""z: "","
"0","                data$z[4], ""<br>"", ""w: "", data$w[4]),  # Add w value to hovertext"
"0","    hoverinfo = ""name+text"""
"0","  ) %>%"
"0","  add_trace("
"0","    x = data$x[5], y = data$y[5], z = data$z[5],"
"0","    type = 'scatter3d', mode = 'markers',"
"0","    marker = list(size = 3),"
"0","    name = 'a\'',"
"0","    hovertext = paste("" x: "", data$x[5], ""<br>"", ""y: "", data$y[5], ""<br>"", ""z: "","
"0","                data$z[5], ""<br>"", ""w: "", data$w[5]),  # Add w value to hovertext"
"0","    hoverinfo = ""name+text"""
"0","  ) %>%"
"0","  # Add lines for each vector with a single color"
"0","  add_trace("
"0","    x = c(0, data$x[1]), y = c(0, data$y[1]), z = c(0, data$z[1]),"
"0","    type = 'scatter3d', mode = 'lines',"
"0","    line = list(color = data$colors[1], width = 4),"
"0","    hoverinfo = ""none"","
"0","    showlegend = FALSE"
"0","  ) %>%"
"0","  add_trace("
"0","    x = c(0, data$x[2]), y = c(0, data$y[2]), z = c(0, data$z[2]),"
"0","    type = 'scatter3d', mode = 'lines',"
"0","    line = list(color = data$colors[2], width = 4),"
"0","    hoverinfo = ""none"","
"0","    showlegend = FALSE"
"0","  ) %>%"
"0","  add_trace("
"0","    x = c(0, data$x[3]), y = c(0, data$y[3]), z = c(0, data$z[3]),"
"0","    type = 'scatter3d', mode = 'lines',"
"0","    line = list(color = data$colors[3], width = 4),"
"0","    hoverinfo = ""none"","
"0","    showlegend = FALSE"
"0","  ) %>%"
"0","  add_trace("
"0","    x = c(0, data$x[4]), y = c(0, data$y[4]), z = c(0, data$z[4]),"
"0","    type = 'scatter3d', mode = 'lines',"
"0","    line = list(color = data$colors[4], width = 4),"
"0","    hoverinfo = ""none"","
"0","    showlegend = FALSE"
"0","  ) %>%"
"0","  add_trace("
"0","    x = c(0, data$x[5]), y = c(0, data$y[5]), z = c(0, data$z[5]),"
"0","    type = 'scatter3d', mode = 'lines',"
"0","    line = list(color = data$colors[5], width = 4),"
"0","    hoverinfo = ""none"","
"0","    showlegend = FALSE"
"0","  ) %>%"
"0","  layout(title = list(text = ""The Solution (a\')"","
"0","                      font = list(size = 20)),"
"0","         scene = list(xaxis = list(title = 'X-axis', range = c(-0.5, 0.75)),"
"0","                      yaxis = list(title = 'Y-axis', range = c(-0.5, 0.75)),"
"0","                      zaxis = list(title = 'Z-axis', range = c(-0.5, 0.75)),"
"0","                      aspectmode = ""cube""),"
"0","         margin = list(t = 100)"
"0","  )"
"0",""
"0","# Create a data frame for the color bar"
"0","color_bar_data <- data.frame("
"0","  x = 0,"
"0","  y = seq(min(data$w), max(data$w), length.out = 100),"
"0","  color = seq(min(data$w), max(data$w), length.out = 100)"
"0",")"
"0",""
"0","# Create the skinny color bar plot with labels"
"0","color_bar_plot <- ggplotly(ggplot(color_bar_data, aes(x = x, y = y, fill = color, text = paste0(""w: "", round(color, 2)))) +"
"0","  geom_tile(width = 5) +  # Adjust width to make the bar skinny"
"0","  scale_fill_gradient(low = ""blue"", high = ""red"", name = ""Color Bar"") +"
"0","  theme_void() +"
"0","  theme("
"0","    legend.position = ""none"","
"0","    axis.text.x = element_blank(),  # Remove x-axis text"
"0","    axis.text.y = element_text(size = 10),"
"0","    axis.title.x = element_blank(),"
"0","    axis.title.y = element_text(size = 14, angle = 90, vjust = 0.5),"
"0","    panel.grid = element_blank(),  # Turn off gridlines"
"0","    panel.grid.major = element_blank(),  # Turn off major gridlines"
"0","    panel.grid.minor = element_blank(),   # Turn off minor gridlines"
"0","  )+"
"0","  labs(y = ""W-axis"")+"
"0","  coord_cartesian(clip = ""off"") +  # Ensure labels are not clipped"
"0","  theme("
"0","    plot.margin = margin(t = 20, b = 0, l = 50, r = 0)  # Adjust plot margins"
"0","  ), tooltip = ""text"") %>%"
"0","  layout("
"0","    hoverlabel = element_blank(),"
"0","    xaxis = list(title = """"),"
"0","    yaxis = list(title = ""W-axis""),"
"0","    height = 200,"
"0","    width = 150"
"0","  )"
"0",""
"0","# Print the color bar plot"
"0","manipulateWidget::combineWidgets(p1, color_bar_plot, nrow = 1)"
